<script>
  var Shopify=Shopify||{};Shopify.optionsMap={},Shopify.updateOptionsInSelector=function(o){switch(o){case 0:var i="root",t=jQuery(".single-option-selector:eq(0)");break;case 1:var i=jQuery(".single-option-selector:eq(0)").val(),t=jQuery(".single-option-selector:eq(1)");break;case 2:var i=jQuery(".single-option-selector:eq(0)").val();i+=" / "+jQuery(".single-option-selector:eq(1)").val();var t=jQuery(".single-option-selector:eq(2)")}var e=t.val();t.empty();for(var p=Shopify.optionsMap[i],n=0;n<p.length;n++){var a=p[n],r=jQuery("<option></option>").val(a).html(a);t.append(r)}jQuery('.swatch[data-option-index="'+o+'"] .swatch-element').each(function(){-1!==jQuery.inArray($(this).attr("data-value"),p)?$(this).removeClass("soldout").show().find(":radio").removeAttr("disabled","disabled").removeAttr("checked"):$(this).addClass("soldout").hide().find(":radio").removeAttr("checked").attr("disabled","disabled")}),-1!==jQuery.inArray(e,p)&&t.val(e),t.trigger("change")},Shopify.linkOptionSelectors=function(o){for(var i=0;i<o.variants.length;i++){var t=o.variants[i];if(t.available){if(Shopify.optionsMap.root=Shopify.optionsMap.root||[],Shopify.optionsMap.root.push(t.option1),Shopify.optionsMap.root=Shopify.uniq(Shopify.optionsMap.root),o.options.length>1){var e=t.option1;Shopify.optionsMap[e]=Shopify.optionsMap[e]||[],Shopify.optionsMap[e].push(t.option2),Shopify.optionsMap[e]=Shopify.uniq(Shopify.optionsMap[e])}if(3===o.options.length){var e=t.option1+" / "+t.option2;Shopify.optionsMap[e]=Shopify.optionsMap[e]||[],Shopify.optionsMap[e].push(t.option3),Shopify.optionsMap[e]=Shopify.uniq(Shopify.optionsMap[e])}}}Shopify.updateOptionsInSelector(0),o.options.length>1&&Shopify.updateOptionsInSelector(1),3===o.options.length&&Shopify.updateOptionsInSelector(2),jQuery(".single-option-selector:eq(0)").change(function(){return Shopify.updateOptionsInSelector(1),3===o.options.length&&Shopify.updateOptionsInSelector(2),!0}),jQuery(".single-option-selector:eq(1)").change(function(){return 3===o.options.length&&Shopify.updateOptionsInSelector(2),!0})};
  {%- if product.available and product.options.size > 1 -%}
  var $addToCartForm = $('form[action="/cart/add"]');
  if (window.MutationObserver && $addToCartForm.length) {
    if (typeof observer === 'object' && typeof observer.disconnect === 'function') {
      observer.disconnect();
    }
    var config = { childList: true, subtree: true };
    var observer = new MutationObserver(function() {      
      Shopify.linkOptionSelectors({{product | json}});
      observer.disconnect();
    });  
    observer.observe($addToCartForm[0], config);
  }
  {%- endif -%}
</script>